(this["webpackJsonpreact-exercise"]=this["webpackJsonpreact-exercise"]||[]).push([[0],{17:function(t,a,e){t.exports=e.p+"person2.e182c057.jpg"},18:function(t,a,e){t.exports=e.p+"bilibili-video2.8097d33f.mp4"},46:function(t,a,e){t.exports=e(65)},51:function(t,a,e){},52:function(t,a,e){t.exports=e.p+"logo.25bf045c.svg"},53:function(t,a,e){},54:function(t,a,e){},56:function(t,a,e){},62:function(t,a){},63:function(t,a){},64:function(t,a){},65:function(t,a,e){"use strict";e.r(a);var n=e(1),i=e.n(n),s=e(16),r=e.n(s),c=(e(51),e(20));e(52),e(53),i.a.createContext(),e(54);var u=e(2),o=e.n(u),m=e(5),d=function(t){if(!t||!t.data)return null;var a=t.width,e=t.height,n=t.data,i=0,s=0,r=Number.MAX_SAFE_INTEGER,c=-1,u=Number.MAX_SAFE_INTEGER,o=-1;for(i=0;i<e;i++)for(s=0;s<a;s++){1===n[i*a+s]&&(s<=u&&(u=s),s>o&&(o=s),i<=r&&(r=i),i>c&&(c=i))}return{top:r,left:u,bottom:c,right:o}},h=e(19),l=(e(56),e(17)),f=e.n(l),p=e(18),v=e.n(p),b=e(3);function g(){var t=Object(n.useRef)(null),a=Object(n.useRef)(null),e=Object(n.useRef)(null),s=Object(n.useRef)(null),r=Object(n.useRef)(null),c=Object(n.useRef)(null);Object(n.useEffect)((function(){function e(){return(e=Object(m.a)(o.a.mark((function e(){var n,i,s,r,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(b.b)({architecture:"MobileNetV1",outputStride:16,multiplier:.75,quantBytes:2}).catch((function(t){console.log("load engine error",t)}));case 2:return n=e.sent,i=(new Date).getTime(),e.next=6,n.segmentPerson(t.current).catch((function(t){console.log("error",t)}));case 6:s=e.sent,console.log(s,"cost ",(new Date).getTime()-i),r=Object(b.c)(s),.7,!1,0,c=a.current,Object(b.a)(c,t.current,r,.7,0,!1);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return function(){e.apply(this,arguments)}(),function(){}}),[t]),Object(n.useEffect)((function(){var t;function a(){return n.apply(this,arguments)}function n(){return(n=Object(m.a)(o.a.mark((function a(){var n,i,m,h,l,f,p,v;return o.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.segmentPerson(e.current).catch((function(t){console.log("error",t)}));case 2:if(n=a.sent){a.next=5;break}return a.abrupt("return");case 5:if(!(i=d(n))){a.next=17;break}if(m={width:n.width,height:n.height,bodyCoordinate:i},u(m),h=c.current){a.next=12;break}return a.abrupt("return");case 12:l=(new XMLSerializer).serializeToString(h),f="data:image/svg+xml;base64,".concat(window.btoa(l)),(p=r.current).style.maskImage="url(".concat(f,")"),p.style.WebkitMaskImage="url(".concat(f,")");case 17:v=Object(b.c)(n),.7,!1,0,Object(b.a)(s.current,e.current,v,.7,0,!1);case 22:case"end":return a.stop()}}),a)})))).apply(this,arguments)}function i(){return(i=Object(m.a)(o.a.mark((function a(){return o.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(b.b)({architecture:"MobileNetV1",outputStride:16,multiplier:.5,quantBytes:2}).catch((function(t){console.log("load engine error",t)}));case 2:t=a.sent;case 3:case"end":return a.stop()}}),a)})))).apply(this,arguments)}return function(){i.apply(this,arguments)}(),e.current.addEventListener("play",(function(){function t(){return n.apply(this,arguments)}function n(){return(n=Object(m.a)(o.a.mark((function n(){return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e&&e.current){n.next=2;break}return n.abrupt("return");case 2:if(e.current.paused||e.current.ended){n.next=6;break}return n.next=5,a();case 5:requestAnimationFrame(t);case 6:case"end":return n.stop()}}),n)})))).apply(this,arguments)}requestAnimationFrame(t)})),function(){}}),[]);var u=function(t){var a=t.width,e=t.height,n=t.bodyCoordinate,i=Object(h.a)("#mySvg");i.attr("width",a).attr("height",e);var s=[n],r=i.selectAll("path").data(s),c=r.enter();r.exit().remove();var u=[];u[0]="".concat(a," 0"),u[1]="".concat(a," ").concat(e),u[2]="0 ".concat(e);var o=function(t){var a=t.top,e=t.left,n=t.bottom,i=t.right;u[3]="0 ".concat(n),u[4]="".concat(e," ").concat(n),u[5]="".concat(i," ").concat(n),u[6]="".concat(i," ").concat(a),u[7]="".concat(e," ").concat(a),u[8]=u[4],u[9]=u[3];var s=u.join(" L ");return s="M".concat("0 0"," ").concat(s," Z")};r.attr("d",o),c.append("path").attr("d",o)};return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",null,"\u4eba\u4f53\u5206\u5272"),i.a.createElement("img",{src:f.a,ref:t}),i.a.createElement("canvas",{id:"canvas",ref:a}),i.a.createElement("div",{className:"videoContainer"},i.a.createElement("video",{controls:!0,src:v.a,id:"myVideo",ref:e}," "),i.a.createElement("div",{className:"danmuContainer",ref:r},i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu "),i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu"))),i.a.createElement("canvas",{id:"videoCanvas",ref:s}),i.a.createElement("svg",{width:"0",height:"0",version:"1.1",xmlns:"http://www.w3.org/2000/svg",id:"mySvg",ref:c}))}var E=function(){var t=Object(n.useState)({}),a=Object(c.a)(t,2),e=(a[0],a[1]);function s(){return new Promise((function(t,a){setTimeout((function(){t({userName:"Tom",loggin:!0})}),1e3)}))}return Object(n.useEffect)((function(){s().then((function(t){e(t)}))}),[]),i.a.createElement(g,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(i.a.createElement(E,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}},[[46,1,2]]]);
//# sourceMappingURL=main.ed052331.chunk.js.map