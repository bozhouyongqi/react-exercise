(this["webpackJsonpreact-exercise"]=this["webpackJsonpreact-exercise"]||[]).push([[0],{53:function(a,t,e){a.exports=e(80)},58:function(a,t,e){},59:function(a,t,e){a.exports=e.p+"static/media/logo.25bf045c.svg"},60:function(a,t,e){},61:function(a,t,e){},63:function(a,t,e){},70:function(a,t){},71:function(a,t){},72:function(a,t){},80:function(a,t,e){"use strict";e.r(t);var n=e(1),i=e.n(n),s=e(24),u=e.n(s),m=(e(58),e(12)),r=(e(59),e(60),e(13)),c=e(5),d=i.a.createContext();e(61);function o(){var a=Object(n.useRef)(null);return i.a.createElement("div",null,i.a.createElement("div",{className:"playerContainer"},i.a.createElement("video",{controls:!0,src:"/bilibili-video.mp4",id:"myVideo",ref:a}),i.a.createElement("div",{className:"danmuContainer danmuMask"},i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu"))),i.a.createElement("div",{className:"mediaContainer"},i.a.createElement("img",{src:"/flower2.jpeg",className:"flower"}),i.a.createElement("div",{className:"mediaDanmu testMaskImage"},i.a.createElement("div",null,"this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",null,"this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",null,"this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",null,"this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",null,"this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",null,"this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",null,"this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",null,"this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",null,"this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",null,"this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",null,"this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",null,"this is a danmu this is a danmu this is a danmu this is a danmu"))))}var l=e(3),h=e.n(l),v=e(9),f=function(a){if(!a||!a.data)return null;var t=a.width,e=a.height,n=a.data,i=0,s=0,u=Number.MAX_SAFE_INTEGER,m=-1,r=Number.MAX_SAFE_INTEGER,c=-1;for(i=0;i<e;i++)for(s=0;s<t;s++){1===n[i*t+s]&&(s<=r&&(r=s),s>c&&(c=s),i<=u&&(u=i),i>m&&(m=i))}return{top:u,left:r,bottom:m,right:c}},E=e(27),p=(e(63),e(64));function b(){var a=Object(n.useState)(""),t=Object(m.a)(a,2),e=(t[0],t[1],Object(n.useRef)(null)),s=Object(n.useRef)(null),u=Object(n.useRef)(null),r=Object(n.useRef)(null),c=Object(n.useRef)(null),d=Object(n.useRef)(null);Object(n.useEffect)((function(){function a(){return(a=Object(v.a)(h.a.mark((function a(){var t,n,i,u,m;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,p.load({architecture:"MobileNetV1",outputStride:16,multiplier:.75,quantBytes:2}).catch((function(a){console.log("load engine error",a)}));case 2:return t=a.sent,n=(new Date).getTime(),a.next=6,t.segmentPerson(e.current).catch((function(a){console.log("error",a)}));case 6:i=a.sent,console.log(i,"cost ",(new Date).getTime()-n),u=p.toMask(i),.7,!1,0,m=s.current,p.drawMask(m,e.current,u,.7,0,!1);case 14:case"end":return a.stop()}}),a)})))).apply(this,arguments)}return function(){a.apply(this,arguments)}(),function(){}}),[e]),Object(n.useEffect)((function(){var a;function t(){return e.apply(this,arguments)}function e(){return(e=Object(v.a)(h.a.mark((function t(){var e,n,i,s,m,l,v,E;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.segmentPerson(u.current).catch((function(a){console.log("error",a)}));case 2:if(e=t.sent){t.next=5;break}return t.abrupt("return");case 5:if(!(n=f(e))){t.next=17;break}if(i={width:e.width,height:e.height,bodyCoordinate:n},o(i),s=d.current){t.next=12;break}return t.abrupt("return");case 12:m=(new XMLSerializer).serializeToString(s),l="data:image/svg+xml;base64,".concat(window.btoa(m)),(v=c.current).style.maskImage="url(".concat(l,")"),v.style.WebkitMaskImage="url(".concat(l,")");case 17:E=p.toMask(e),.7,!1,0,p.drawMask(r.current,u.current,E,.7,0,!1);case 22:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function n(){return(n=Object(v.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.load({architecture:"MobileNetV1",outputStride:16,multiplier:.5,quantBytes:2}).catch((function(a){console.log("load engine error",a)}));case 2:a=t.sent;case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return function(){n.apply(this,arguments)}(),u.current.addEventListener("play",(function(){function a(){return e.apply(this,arguments)}function e(){return(e=Object(v.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u&&u.current){e.next=2;break}return e.abrupt("return");case 2:if(u.current.paused||u.current.ended){e.next=6;break}return e.next=5,t();case 5:requestAnimationFrame(a);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}requestAnimationFrame(a)})),function(){}}),[]);var o=function(a){var t=a.width,e=a.height,n=a.bodyCoordinate,i=Object(E.a)("#mySvg");i.attr("width",t).attr("height",e);var s=[n],u=i.selectAll("path").data(s),m=u.enter();u.exit().remove();var r=[];r[0]="".concat(t," 0"),r[1]="".concat(t," ").concat(e),r[2]="0 ".concat(e);var c=function(a){var t=a.top,e=a.left,n=a.bottom,i=a.right;r[3]="0 ".concat(n),r[4]="".concat(e," ").concat(n),r[5]="".concat(i," ").concat(n),r[6]="".concat(i," ").concat(t),r[7]="".concat(e," ").concat(t),r[8]=r[4],r[9]=r[3];var s=r.join(" L ");return s="M".concat("0 0"," ").concat(s," Z")};u.attr("d",c),m.append("path").attr("d",c)};return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",null,"\u4eba\u4f53\u5206\u5272"),i.a.createElement("img",{src:"/weiya5.jpeg",ref:e}),i.a.createElement("canvas",{id:"canvas",ref:s}),i.a.createElement("div",{className:"videoContainer"},i.a.createElement("video",{controls:!0,src:"/bilibili-video2.mp4",id:"myVideo",ref:u}," "),i.a.createElement("div",{className:"danmuContainer",ref:c},i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu "),i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu"),i.a.createElement("div",{className:"danmuContent"},"this is a danmu this is a danmu this is a danmu this is a danmu this is a danmu"))),i.a.createElement("canvas",{id:"videoCanvas",ref:r}),i.a.createElement("svg",{width:"0",height:"0",version:"1.1",xmlns:"http://www.w3.org/2000/svg",id:"mySvg",ref:d}))}var g=function(){var a=Object(n.useState)({}),t=Object(m.a)(a,2),e=t[0],s=t[1];function u(){return new Promise((function(a,t){setTimeout((function(){a({userName:"Tom",loggin:!0})}),1e3)}))}return Object(n.useEffect)((function(){u().then((function(a){s(a)}))}),[]),i.a.createElement(r.a,null,i.a.createElement(d.Provider,{value:e},i.a.createElement(r.b,{to:"/videoPlayer"},"\u89c6\u9891\u64ad\u653e\u5668"),i.a.createElement("br",null),i.a.createElement(r.b,{to:"/pictureSegmentation"},"\u4eba\u4f53\u5206\u5272"),i.a.createElement("br",null),i.a.createElement("br",null),i.a.createElement("input",{type:"button",onClick:function(){e.loggin?s({}):u().then((function(a){s(a)}))},value:e.loggin?"\u9000\u51fa":"\u767b\u5f55"}),i.a.createElement(c.a,{path:"/videoPlayer",component:o}),i.a.createElement(c.a,{path:"/pictureSegmentation",component:b})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));u.a.render(i.a.createElement(g,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(a){a.unregister()}))}},[[53,1,2]]]);
//# sourceMappingURL=main.798ac6af.chunk.js.map